function updateDashboardData(){get_impression_or_clicks(),updateTopSegments()}function updateTopSegments(){var t=($("#campaign_status").val(),new Date),e=new Date;void 0==$(".daterangepicker_start_input > input:nth-child(2)").val()?t=moment().subtract(30,"days"):(t=$(".daterangepicker_start_input > input:nth-child(2)").val()+" 00:00:00",e=$(".daterangepicker_end_input > input:nth-child(2)").val()+" 23:59:59"),$.ajax({type:"GET",url:"/advertisers/top_segments",dataType:"json",data:{start_date:t,end_date:e},success:function(t){$("#top-demography").html(t.demography.name),$("#top-demography-val").html(numberToShortString(t.demography.val)),$("#top-os").html(t.os.name),$("#top-os-val").html(numberToShortString(t.os.val)),$("#top-category").html(t.category.name),$("#top-category-val").html(numberToShortString(t.category.val)),$("#top-geo").html(t.geo.name),$("#top-geo-val").html(numberToShortString(t.geo.val))},error:function(){}})}function numberToShortString(t){return 1e3>t?t:1e6>t?Math.round(t/1e3)+" K":1e9>t?Math.round(t/1e6)+" M":Math.round(t/1e9)+" G"}function get_impression_or_clicks(){$(".spinnerShow").show(),status=$("#campaign_status").val(),type=$("#graph_type > select:nth-child(1)").val(),void 0==$(".daterangepicker_start_input > input:nth-child(2)").val()?(end_date=new Date,start_date=moment().subtract(30,"days")):(start_date=$(".daterangepicker_start_input > input:nth-child(2)").val()+" 00:00:00",end_date=$(".daterangepicker_end_input > input:nth-child(2)").val()+" 23:59:59"),$.ajax({type:"GET",url:"/advertisers/get_impression_or_click_for_campaigns",dataType:"json",data:{graph_type:type,campaign_status:status,campaign_start:start_date,campaign_end:end_date},success:function(t){display_chart(t);var e=[],a=t.values;for(i=0;i<t.values.length;i++)e.push(a[i][1]);if("VTR"==type){var a=data_sum(e);a>100&&(a=100),$("#campaign_value").html(a+"%")}else $("#campaign_value").html(data_sum(e));$("#selected_type").html(type)},error:function(){$("#selected_type").html(type)}}),$.get("/campaigns.js?for_status="+status+"&for_from_date="+start_date+"&for_to_date="+end_date)}function data_sum(t){for(sum=0,i=0;i<t.length;i++)sum+=parseInt(t[i]);return convert_number(sum)}function convert_number(t){t=parseInt(t);var e;return t>1e6?(t/=1e6,e=" M"):t>1e3?(t/=1e3,e=" K"):e=" ","Spend"==$("#graph_type > select:nth-child(1)").val()?"$ "+t:(t=parseInt(t),t+e)}